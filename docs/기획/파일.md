## 1.1 모듈 개요

파일 관리 모듈은 Portal NAS 시스템의 핵심 기능으로,

프로젝트 및 WBS 구조 하위에서 파일의 **생성, 탐색, 활용, 구조 변경, 제거** 전 과정을 관리한다.

본 모듈은 내부 사용자(Admin, Manager, User)를 대상으로 하며,

파일의 생애주기와 권한 정책에 따라 안정적이고 일관된 파일 관리 경험을 제공하는 것을 목표로 한다.

---

## 1.2 사용자 및 권한 범위

파일 관리 모듈은 사용자 권한 계층(Role Hierarchy)을 기반으로 동작한다.

```
Admin ⊃ Manager ⊃ User

```

- 상위 권한은 하위 권한의 모든 기능을 포함한다.
- 권한에 따라 파일 조작 가능 범위가 제한된다.

### 권한별 기능 범위 요약(Public 권한 기준)

| 기능 | User | Manager | Admin |
| --- | --- | --- | --- |
| 파일 업로드 | O | O | O |
| 파일 미리보기 | O | O | O |
| 파일 다운로드 | X | O | O |
| 파일 이동 | X | X | O |
| 파일 삭제 | X | X | O |
| 폴더 생성 | X | O | O |
| 폴더 이동 | X | O | O |
| 폴더 삭제 | X | O | O |
| 폴더 수정 | X | O | O |

---

## 1.3 주요 기능 구성

파일 관리 모듈은 다음과 같은 기능 그룹으로 구성된다.

### 1.3.1 파일 생성 / 유입

- 파일 업로드
- 업로드 진행 상태 표시
- 업로드 실패 처리

### 1.3.2 파일 탐색

- 폴더 트리 탐색
- 파일 목록 조회
- 정렬
- 페이징 또는 무한 스크롤

### 1.3.3 파일 활용

- 파일 정보 조회
- 파일 미리보기
- 파일 다운로드
- 파일 묶음 다운로드
- 파일 위치 공유
- 파일 경로 복사

※ 파일 관리 화면에서는 단일 선택 및 다중 선택을 지원하며, 다중 선택은 파일 활용 및 구조 변경 기능에 공통으로 적용된다.

### 1.3.4 파일 구조 변경

- 파일 이동 (단일)
- 파일 이동 (다중)

### 1.3.5 파일 제거

- 파일 삭제 (휴지통 이동)

※ 파일 삭제는 실제 데이터 삭제가 아닌 **휴지통 이동**을 의미하며, 영구 삭제는 휴지통 관리 모듈에서 수행된다.

### **1.3.6 폴더 관리**

- 폴더 생성
- 폴더 이동
- 폴더 삭제
- 폴더 수정

---

## 1.4 파일 상태 모델

파일은 시스템 내에서 다음과 같은 상태 생애주기를 가진다.

```
NON_EXISTENT → UPLOADING → ACTIVE → DELETED → REMOVED

```

### 상태 정의

| 상태 | 설명 |
| --- | --- |
| NON_EXISTENT | 파일이 존재하지 않는 상태 |
| UPLOADING | 파일 업로드가 진행 중인 상태 |
| ACTIVE | 정상적으로 저장되어 사용 가능한 상태 |
| DELETED | 삭제되어 휴지통으로 이동된 상태 |
| REMOVED | 영구 삭제된 상태 (복구 불가) |

### 상태 전이 원칙

- 파일은 업로드 완료 후 ACTIVE 상태가 된다.
- 삭제 시 DELETED 상태로 전이되며, 즉시 시스템에서 제거되지 않는다.
- REMOVED 상태로 전이된 파일은 시스템에서 완전히 제거되며, 복구가 불가능하다.

---

## 1.5 파일 업로드 정책

### 1.5.1 업로드 방식

파일 업로드는 대용량 파일 및 네트워크 불안정 환경을 고려하여 **청크 업로드(Chunk Upload)** 방식을 기본으로 한다.

- 파일은 여러 개의 조각(chunk)으로 분할되어 전송된다.
- 업로드 중 중단이 발생한 경우, 이미 전송된 조각은 재전송하지 않는다.
- 업로드 재개(resume)를 지원한다.

※위 기능 구현이 불가능한 경우, 파일 용량에 제한을 두고 업로드 기능을 구현한다. 업로드가 불가능한 용량의 파일인 경우 NAS에 직접 접근해 업로드 하라는 알림 문구를 보여준다.

### 1.5.2 업로드 진행 상태

- 업로드 진행률을 사용자에게 실시간으로 표시한다.
- 업로드 완료 시 파일은 ACTIVE 상태로 전이된다.
- 파일은 ACTIVE 상태일 때 리스트에 보여진다.
- 업로드 완료는 DMS와 NAS 동기화가 완료되었을 때를 의미한다.

### 1.5.3 업로드 실패 처리

- 네트워크 또는 시스템 오류로 업로드가 실패한 경우, 실패 메시지를 표시한다.
- 사용자는 재시도를 통해 업로드를 다시 수행할 수 있다.

---

## 1.6 파일 이동 정책

- 파일 이동은 Admin 권한 사용자만 수행할 수 있다.
- 이동 대상 폴더의 유효성을 검증한 후 이동을 수행한다.
- 다중 파일 이동 시, 이동 불가한 파일은 제외하고 나머지 파일만 이동한다.
- 이동 결과는 파일 단위로 처리 결과를 안내한다.

---

## 1.7 파일 삭제 정책

- 파일 삭제는 **휴지통 이동**을 의미한다.
- Admin 권한 사용자만 파일 삭제를 수행할 수 있다.
- 파일 삭제 후 파일은 DELETED 상태로 전이되며, 휴지통 관리 모듈에서 관리된다.

### 삭제 시 유의사항

- 파일이 외부 공유 중인 경우, 파일 삭제 시 해당 외부 공유 권한은 즉시 무효화된다.
- 삭제된 파일은 휴지통 보존 기간 내에만 복구 가능하다.

---

## **1.8 폴더 관리 정책**

### 1.8.1 폴더 관리 개요

폴더 관리는 파일을 담는 구조를 관리하는 기능으로,

폴더 생성, 이동, 삭제, 수정을 통해 파일 저장 구조를 구성한다.

폴더 관리 기능은 **Manager 이상 권한 사용자만 수행 가능**하다.

---

### 1.8.2 폴더 생성 정책

- 폴더는 현재 선택된 경로 하위에 생성된다.
- 동일 경로 내에서 폴더명 중복은 허용하지 않는다.
    - 중복된 폴더명은 사용할 수 없다고 알림을 보여준다. (NAS기능 참고)

---

### 1.8.3 폴더 이동 정책

- 폴더 이동은 Manager 이상 권한 사용자만 수행할 수 있다.

---

### 1.8.4 폴더 이동 시 영향 범위

- 폴더 이동 시, 해당 폴더 하위의 모든 파일 및 하위 폴더는 함께 이동된다.
- 파일의 상태 및 데이터는 변경되지 않으며, 경로 정보만 갱신된다.
- 외부 공유 중인 파일의 공유 권한은 유지된다.

---

### 1.8.5 폴더 삭제 정책

- 폴더 삭제는 Manager 이상 권한 사용자만 수행할 수 있다.
- 폴더 삭제 전, 하위 파일 및 하위 폴더 존재 여부를 확인한다.

### 폴더 삭제 제한 조건

- 폴더 하위에 파일 또는 하위 폴더가 존재하는 경우, 삭제를 허용하지 않는다.
- 해당 경우, 사용자는 먼저 하위 파일/폴더를 이동 또는 삭제해야 한다.

---

### 1.8.6 폴더 삭제 처리 원칙

- 폴더 삭제는 **폴더 구조만 제거**하며, 파일 삭제(휴지통 이동)는 포함하지 않는다.
- 삭제된 폴더는 복구할 수 없다.
- 폴더 삭제 이력은 로그로 기록된다.

---

### 1.8.7 폴더 수정 정책

- 폴더 수정은 폴더 이름 변경을 의미한다.
- 폴더 수정은 Manager 이상 권한 사용자만 수행할 수 있다.
- 동일 경로 내에서 폴더명 중복은 허용하지 않는다.
- 폴더 수정 시, 해당 폴더 하위의 파일 및 하위 폴더에는 영향을 주지 않는다.
- 외부 공유 중인 파일의 공유 권한에는 영향을 주지 않는다.

---

## 1.9 예외 및 공통 처리 원칙

- 권한이 없는 사용자의 파일 조작 시도는 차단된다.
- 모든 파일 조작 이력은 백엔드에 로그로 기록된다다.

---

### ✅ 1장 요약

- 파일 관리 모듈은 **파일 생애주기 중심 설계**를 따른다.
- 기능, 상태, 권한을 명확히 분리하여 확장성과 안정성을 확보한다.
- 예외 처리 및 정책은 일관된 기준으로 관리한다.