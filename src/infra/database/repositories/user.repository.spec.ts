/**
 * ============================================================
 * ğŸ“¦ User Repository í…ŒìŠ¤íŠ¸
 * ============================================================
 *
 * ğŸ¯ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ:
 *   - UserRepository í´ë˜ìŠ¤
 *
 * ğŸ“‹ ë¹„ì¦ˆë‹ˆìŠ¤ ë§¥ë½:
 *   - User ë„ë©”ì¸ ì—”í‹°í‹°ì˜ ì˜ì†ì„± ê´€ë¦¬
 *   - TypeORMì„ ì‚¬ìš©í•œ DB ì‘ì—… ìˆ˜í–‰
 *
 * âš ï¸ ì¤‘ìš” ê³ ë ¤ì‚¬í•­:
 *   - ì‹¤ì œ DB ëŒ€ì‹  Mock Repository ì‚¬ìš©
 *   - Mapperë¥¼ í†µí•œ ë„ë©”ì¸/ORM ë³€í™˜ ê²€ì¦
 * ============================================================
 */
import { Test, TestingModule } from '@nestjs/testing';
import { getRepositoryToken } from '@nestjs/typeorm';
import { Repository, In } from 'typeorm';
import { UserRepository } from './user.repository';
import { UserOrmEntity } from '../entities/user.orm-entity';
import { User } from '../../../domain/user/entities/user.entity';

describe('UserRepository', () => {
  let repository: UserRepository;
  let mockTypeOrmRepo: jest.Mocked<Repository<UserOrmEntity>>;

  /**
   * ğŸ­ Mock ì„¤ì •
   * ğŸ“ mockTypeOrmRepo:
   *   - ì‹¤ì œ ë™ì‘: TypeORM Repositoryë¡œ DB ì‘ì—… ìˆ˜í–‰
   *   - Mock ì´ìœ : ì‹¤ì œ DB ì—°ê²° ì—†ì´ Repository ë¡œì§ í…ŒìŠ¤íŠ¸
   */
  beforeEach(async () => {
    mockTypeOrmRepo = {
      save: jest.fn(),
      findOne: jest.fn(),
      find: jest.fn(),
      delete: jest.fn(),
    } as unknown as jest.Mocked<Repository<UserOrmEntity>>;

    const module: TestingModule = await Test.createTestingModule({
      providers: [
        UserRepository,
        {
          provide: getRepositoryToken(UserOrmEntity),
          useValue: mockTypeOrmRepo,
        },
      ],
    }).compile();

    repository = module.get<UserRepository>(UserRepository);
  });

  /**
   * ğŸ“Œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤: User ì €ì¥
   *
   * ğŸ¯ ê²€ì¦ ëª©ì :
   *   ë„ë©”ì¸ ì—”í‹°í‹°ë¥¼ ORM ì—”í‹°í‹°ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
   *
   * âœ… ê¸°ëŒ€ ê²°ê³¼:
   *   ì €ì¥ëœ ì—”í‹°í‹°ê°€ ë„ë©”ì¸ ì—”í‹°í‹°ë¡œ ë°˜í™˜ë¨
   */
  describe('save', () => {
    it('should save a User and return domain entity', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const user = new User({
        id: 'user-123',
        roleId: 'role-456',
        isActive: true,
        createdAt: new Date('2026-01-01'),
        updatedAt: new Date('2026-01-01'),
      });

      const savedOrmEntity: UserOrmEntity = {
        id: 'user-123',
        roleId: 'role-456',
        isActive: true,
        createdAt: new Date('2026-01-01'),
        updatedAt: new Date('2026-01-01'),
      };

      mockTypeOrmRepo.save.mockResolvedValue(savedOrmEntity);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const result = await repository.save(user);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(mockTypeOrmRepo.save).toHaveBeenCalled();
      expect(result).toBeInstanceOf(User);
      expect(result.id).toBe('user-123');
      expect(result.roleId).toBe('role-456');
    });
  });

  /**
   * ğŸ“Œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤: IDë¡œ User ì¡°íšŒ
   *
   * ğŸ¯ ê²€ì¦ ëª©ì :
   *   IDë¡œ Userë¥¼ ì¡°íšŒí•˜ê³  ë„ë©”ì¸ ì—”í‹°í‹°ë¡œ ë°˜í™˜
   *
   * âœ… ê¸°ëŒ€ ê²°ê³¼:
   *   ì¡´ì¬í•˜ë©´ ë„ë©”ì¸ ì—”í‹°í‹° ë°˜í™˜, ì—†ìœ¼ë©´ null
   */
  describe('findById', () => {
    it('should find User by ID and return domain entity', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const ormEntity: UserOrmEntity = {
        id: 'user-123',
        roleId: 'role-456',
        isActive: true,
        createdAt: new Date(),
        updatedAt: new Date(),
      };

      mockTypeOrmRepo.findOne.mockResolvedValue(ormEntity);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const result = await repository.findById('user-123');

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(mockTypeOrmRepo.findOne).toHaveBeenCalledWith({
        where: { id: 'user-123' },
      });
      expect(result).toBeInstanceOf(User);
      expect(result?.id).toBe('user-123');
    });

    it('should return null when User not found', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      mockTypeOrmRepo.findOne.mockResolvedValue(null);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const result = await repository.findById('non-existent');

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(result).toBeNull();
    });
  });

  /**
   * ğŸ“Œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤: ì „ì²´ User ëª©ë¡ ì¡°íšŒ
   *
   * ğŸ¯ ê²€ì¦ ëª©ì :
   *   ëª¨ë“  Userë¥¼ ì¡°íšŒí•˜ì—¬ ë„ë©”ì¸ ì—”í‹°í‹° ë°°ì—´ë¡œ ë°˜í™˜
   *
   * âœ… ê¸°ëŒ€ ê²°ê³¼:
   *   ëª¨ë“  Userê°€ ë„ë©”ì¸ ì—”í‹°í‹° ë°°ì—´ë¡œ ë°˜í™˜ë¨
   */
  describe('findAll', () => {
    it('should find all Users and return domain entities', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const ormEntities: UserOrmEntity[] = [
        {
          id: 'user-1',
          roleId: 'role-1',
          isActive: true,
          createdAt: new Date(),
          updatedAt: new Date(),
        },
        {
          id: 'user-2',
          roleId: null,
          isActive: false,
          createdAt: new Date(),
          updatedAt: new Date(),
        },
      ];

      mockTypeOrmRepo.find.mockResolvedValue(ormEntities);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const result = await repository.findAll();

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(mockTypeOrmRepo.find).toHaveBeenCalled();
      expect(result).toHaveLength(2);
      expect(result[0]).toBeInstanceOf(User);
      expect(result[1]).toBeInstanceOf(User);
    });
  });

  /**
   * ğŸ“Œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤: í™œì„± User ëª©ë¡ ì¡°íšŒ
   *
   * ğŸ¯ ê²€ì¦ ëª©ì :
   *   isActiveê°€ trueì¸ Userë§Œ ì¡°íšŒ
   *
   * âœ… ê¸°ëŒ€ ê²°ê³¼:
   *   í™œì„± ìƒíƒœ Userë§Œ ë°˜í™˜ë¨
   */
  describe('findAllActive', () => {
    it('should find all active Users', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const ormEntities: UserOrmEntity[] = [
        {
          id: 'user-1',
          roleId: 'role-1',
          isActive: true,
          createdAt: new Date(),
          updatedAt: new Date(),
        },
      ];

      mockTypeOrmRepo.find.mockResolvedValue(ormEntities);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const result = await repository.findAllActive();

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(mockTypeOrmRepo.find).toHaveBeenCalledWith({
        where: { isActive: true },
      });
      expect(result).toHaveLength(1);
    });
  });

  /**
   * ğŸ“Œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤: ì—¬ëŸ¬ IDë¡œ User ì¼ê´„ ì¡°íšŒ
   *
   * ğŸ¯ ê²€ì¦ ëª©ì :
   *   ì—¬ëŸ¬ IDì— í•´ë‹¹í•˜ëŠ” Userë¥¼ ì¼ê´„ ì¡°íšŒ
   *
   * âœ… ê¸°ëŒ€ ê²°ê³¼:
   *   ìš”ì²­í•œ IDì— í•´ë‹¹í•˜ëŠ” Userë“¤ë§Œ ë°˜í™˜ë¨
   */
  describe('findByIds', () => {
    it('should find Users by multiple IDs', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const ormEntities: UserOrmEntity[] = [
        {
          id: 'user-1',
          roleId: 'role-1',
          isActive: true,
          createdAt: new Date(),
          updatedAt: new Date(),
        },
        {
          id: 'user-2',
          roleId: 'role-2',
          isActive: true,
          createdAt: new Date(),
          updatedAt: new Date(),
        },
      ];

      mockTypeOrmRepo.find.mockResolvedValue(ormEntities);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const result = await repository.findByIds(['user-1', 'user-2']);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(mockTypeOrmRepo.find).toHaveBeenCalledWith({
        where: { id: In(['user-1', 'user-2']) },
      });
      expect(result).toHaveLength(2);
    });

    it('should return empty array when no IDs provided', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ë¹ˆ ID ë°°ì—´

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const result = await repository.findByIds([]);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(result).toHaveLength(0);
    });
  });

  /**
   * ğŸ“Œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤: User ì‚­ì œ
   *
   * ğŸ¯ ê²€ì¦ ëª©ì :
   *   IDë¡œ Userë¥¼ ì‚­ì œ
   *
   * âœ… ê¸°ëŒ€ ê²°ê³¼:
   *   ì‚­ì œ ë©”ì„œë“œê°€ í˜¸ì¶œë¨
   */
  describe('delete', () => {
    it('should delete User by ID', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      mockTypeOrmRepo.delete.mockResolvedValue({ affected: 1, raw: {} });

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      await repository.delete('user-123');

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(mockTypeOrmRepo.delete).toHaveBeenCalledWith('user-123');
    });
  });

  /**
   * ğŸ“Œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤: ì—¬ëŸ¬ User ì¼ê´„ ì €ì¥
   *
   * ğŸ¯ ê²€ì¦ ëª©ì :
   *   ì—¬ëŸ¬ Userë¥¼ í•œ ë²ˆì— ì €ì¥ (ë°°ì¹˜ ë™ê¸°í™” ì‹œ ì‚¬ìš©)
   *
   * âœ… ê¸°ëŒ€ ê²°ê³¼:
   *   ëª¨ë“  Userê°€ ì €ì¥ë˜ê³  ë„ë©”ì¸ ì—”í‹°í‹° ë°°ì—´ë¡œ ë°˜í™˜ë¨
   */
  describe('saveMany', () => {
    it('should save multiple Users', async () => {
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ“¥ GIVEN (ì‚¬ì „ ì¡°ê±´ ì„¤ì •)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const users = [
        new User({
          id: 'user-1',
          roleId: null,
          isActive: true,
          createdAt: new Date(),
          updatedAt: new Date(),
        }),
        new User({
          id: 'user-2',
          roleId: null,
          isActive: true,
          createdAt: new Date(),
          updatedAt: new Date(),
        }),
      ];

      const savedOrmEntities: UserOrmEntity[] = [
        {
          id: 'user-1',
          roleId: null,
          isActive: true,
          createdAt: new Date(),
          updatedAt: new Date(),
        },
        {
          id: 'user-2',
          roleId: null,
          isActive: true,
          createdAt: new Date(),
          updatedAt: new Date(),
        },
      ];

      mockTypeOrmRepo.save.mockResolvedValue(savedOrmEntities as any);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // ğŸ¬ WHEN (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      const result = await repository.saveMany(users);

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // âœ… THEN (ê²°ê³¼ ê²€ì¦)
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      expect(mockTypeOrmRepo.save).toHaveBeenCalled();
      expect(result).toHaveLength(2);
    });
  });
});
