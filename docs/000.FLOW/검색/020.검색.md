# 검색 시스템

## 개요

파일 및 폴더를 이름 기준으로 검색하는 기능을 제공합니다.
- 검색 기준: 파일명, 폴더명
- 검색 범위: 전체 검색 / 특정 폴더 하위 검색

---

## 검색 정의

### 검색 조건 (Input)

| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| `query` | string | ✅ | 검색어 (파일명/폴더명에 포함된 문자열) |
| `searchPath` | string | ❌ | 검색 시작 경로 (미지정 시 전체 검색) |
| `type` | enum | ❌ | 검색 대상 타입 (ALL / FILE / FOLDER) |
| `mimeTypes` | string[] | ❌ | 파일 유형 필터 (예: image/*, application/pdf) |
| `minSize` | number | ❌ | 최소 파일 크기 (bytes) |
| `maxSize` | number | ❌ | 최대 파일 크기 (bytes) |
| `modifiedAfter` | datetime | ❌ | 수정일 시작 범위 |
| `modifiedBefore` | datetime | ❌ | 수정일 종료 범위 |
| `page` | number | ❌ | 페이지 번호 (기본값: 1) |
| `limit` | number | ❌ | 페이지당 결과 수 (기본값: 20, 최대: 100) |
| `sortBy` | enum | ❌ | 정렬 기준 (NAME / SIZE / MODIFIED_AT / TYPE) |
| `sortOrder` | enum | ❌ | 정렬 순서 (ASC / DESC) |

### 검색 결과 (Output)

| 필드 | 타입 | 설명 |
|------|------|------|
| `id` | UUID | 파일/폴더 ID |
| `name` | string | 파일명 또는 폴더명 |
| `type` | enum | 결과 타입 (FILE / FOLDER) |
| `path` | string | 전체 경로 (예: /project/docs/readme.md) |
| `parentPath` | string | 상위 폴더 경로 |
| `mimeType` | string | MIME 타입 (파일만 해당) |
| `bytes` | number | 파일 크기 (파일만 해당) |
| `modifiedAt` | datetime | 수정일시 |
| `createdAt` | datetime | 생성일시 |
| `storageStatus` | object | 저장소 상태 (cache, nas) |

---

## 검색 모드

### 1) 전체 검색 (Global Search)

**설명**: 루트 경로(/)부터 모든 파일과 폴더를 대상으로 검색

```
┌─────────────────────────────────────────────────────────────────────┐
│  [전체 검색]                                                         │
│                                                                     │
│  요청:                                                               │
│  GET /api/search?query=report                                       │
│                                                                     │
│  검색 범위:                                                          │
│  /                                                                  │
│  ├── project/                                                       │
│  │   ├── docs/                                                      │
│  │   │   └── report.md  ← 검색됨                                    │
│  │   └── src/                                                       │
│  ├── archive/                                                       │
│  │   └── 2024-report.pdf  ← 검색됨                                  │
│  └── report-template/  ← 검색됨 (폴더)                              │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2) 특정 폴더 하위 검색 (Scoped Search)

**설명**: 지정된 경로 하위의 파일과 폴더만 대상으로 검색

```
┌─────────────────────────────────────────────────────────────────────┐
│  [특정 폴더 하위 검색]                                               │
│                                                                     │
│  요청:                                                               │
│  GET /api/search?query=report&searchPath=/project                   │
│                                                                     │
│  검색 범위: /project 하위만                                          │
│  /                                                                  │
│  ├── project/  ← 검색 시작점                                        │
│  │   ├── docs/                                                      │
│  │   │   └── report.md  ← 검색됨                                    │
│  │   └── src/                                                       │
│  ├── archive/                                                       │
│  │   └── 2024-report.pdf  ← 검색 범위 외 (제외)                     │
│  └── report-template/  ← 검색 범위 외 (제외)                        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 엔티티 (검색 관련)

### <search_logs> (검색 로그 - 선택적)

*목적: 검색 패턴 분석, 자동완성 개선, 인기 검색어 등*

```
id (UUID, PK)
userId (검색 수행자)
query (검색어)
searchPath (검색 경로, NULL = 전체)
resultCount (결과 수)
executionTimeMs (검색 소요 시간)
filters (적용된 필터, JSON)
createdAt (검색 시각)

*인덱스*
INDEX(userId, createdAt)
INDEX(query, createdAt)  -- 인기 검색어 분석용
INDEX(createdAt)
```

### <search_index> (검색 인덱스 - 선택적, 성능 최적화용)---추후 반영

*목적: 대용량 데이터에서 빠른 검색을 위한 별도 인덱스 테이블*

```
id (UUID, PK)
entityType (FILE / FOLDER)
entityId (FK → files.id 또는 folders.id)
name (검색 대상 이름, 정규화됨)
nameLower (소문자 변환, 대소문자 무시 검색용)
nameTokens (토큰화된 이름, JSON 배열) -- 부분 일치 검색용
path (전체 경로)
pathTokens (경로 토큰, JSON 배열)
mimeType (파일만)
bytes (파일만)
state (ACTIVE / TRASHED / DELETED)
updatedAt (마지막 업데이트)

*인덱스*
INDEX(nameLower)  -- LIKE '%query%' 최적화
INDEX(path)  -- 경로 기반 필터링
INDEX(state, nameLower)  -- 상태 + 이름 복합 검색
FULLTEXT INDEX(name, path)  -- 전문 검색 (MySQL/PostgreSQL)
```

---

## API 엔드포인트

### 검색 API

| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api/search` | 파일/폴더 검색 |
| GET | `/api/search/suggestions` | 검색어 자동완성 |
| GET | `/api/search/recent` | 최근 검색어 목록 |
| DELETE | `/api/search/recent` | 최근 검색어 삭제 |
| GET | `/api/search/popular` | 인기 검색어 (관리자용) |

---

## 플로우

### 검색 실행 플로우

**Trace/Span 흐름**

```
[요청 시작]
INSERT request_transactions (traceId, method=GET, path=/api/search, status=PENDING)

[Span 기록 - 각 단계별]
├─ SPAN: api.request_validate       -- 요청 파라미터 검증
├─ SPAN: db.search_path_validate    -- searchPath 유효성 검증 (선택)
├─ SPAN: db.search_files            -- files 테이블 검색
├─ SPAN: db.search_folders          -- folders 테이블 검색
├─ SPAN: db.search_merge_results    -- 결과 병합 및 정렬
├─ SPAN: db.search_log_insert       -- 검색 로그 기록 (선택)
└─ SPAN: api.response               -- 응답 생성

[요청 완료]
UPDATE request_transactions SET status=SUCCESS/FAIL, completedAt=NOW()
```

**플로우 상세**

```
┌─────────────────────────────────────────────────────────────────────┐
│  [검색 실행 플로우]                                                   │
│                                                                     │
│  1. 사용자 → API: GET /api/search?query=xxx&searchPath=/path        │
│                                                                     │
│  2. 요청 파라미터 검증 → SPAN: api.request_validate                  │
│     ┌─────────────────────────────────────────────────────────────┐ │
│     │ • query 길이 검증 (최소 1자, 최대 100자)                     │ │
│     │ • page, limit 범위 검증                                     │ │
│     │ • sortBy, sortOrder 유효값 검증                             │ │
│     │ • mimeTypes 형식 검증                                       │ │
│     └─────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  3. (searchPath 지정 시) 경로 유효성 검증 → SPAN: db.search_path_validate
│     SELECT id FROM folders WHERE path = ? AND state = 'ACTIVE'      │
│     -- 존재하지 않는 경로면 404 반환                                 │
│                                                                     │
│  4. 파일 검색 → SPAN: db.search_files                               │
│     SELECT f.*, fso.availabilityStatus                              │
│     FROM files f                                                    │
│     LEFT JOIN file_storage_objects fso ON f.id = fso.fileId         │
│     LEFT JOIN folders fo ON f.folderId = fo.id                      │
│     WHERE f.name ILIKE '%query%'                                    │
│       AND f.state = 'ACTIVE'                                        │
│       AND (searchPath IS NULL OR fo.path LIKE 'searchPath%')        │
│       AND (추가 필터 조건들...)                                     │
│     ORDER BY {sortBy} {sortOrder}                                   │
│     LIMIT ? OFFSET ?                                                │
│                                                                     │
│  5. 폴더 검색 → SPAN: db.search_folders                             │
│     SELECT fo.*, fso.availabilityStatus                             │
│     FROM folders fo                                                 │
│     LEFT JOIN folder_storage_objects fso ON fo.id = fso.folderId    │
│     WHERE fo.name ILIKE '%query%'                                   │
│       AND fo.state = 'ACTIVE'                                       │
│       AND (searchPath IS NULL OR fo.path LIKE 'searchPath%')        │
│     ORDER BY {sortBy} {sortOrder}                                   │
│     LIMIT ? OFFSET ?                                                │
│                                                                     │
│  6. 결과 병합 및 정렬 → SPAN: db.search_merge_results                │
│     ┌─────────────────────────────────────────────────────────────┐ │
│     │ • 파일 + 폴더 결과 통합                                      │ │
│     │ • 전체 정렬 기준 적용                                        │ │
│     │ • 페이지네이션 처리                                          │ │
│     │ • 총 결과 수 계산                                            │ │
│     └─────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  7. (선택) 검색 로그 기록 → SPAN: db.search_log_insert               │
│     INSERT search_logs (userId, query, searchPath, resultCount, ...) │
│                                                                     │
│  8. 응답 반환 → SPAN: api.response                                  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 검색 쿼리 상세

### 기본 검색 쿼리 (PostgreSQL 예시)

```sql
-- 파일 검색
SELECT 
    f.id,
    f.name,
    'FILE' as type,
    CONCAT(fo.path, '/', f.name) as path,
    fo.path as parentPath,
    f.mimeType,
    f.bytes,
    f.updatedAt as modifiedAt,
    f.createdAt,
    JSON_BUILD_OBJECT(
        'cache', cache_fso.availabilityStatus,
        'nas', nas_fso.availabilityStatus
    ) as storageStatus
FROM files f
INNER JOIN folders fo ON f.folderId = fo.id
LEFT JOIN file_storage_objects cache_fso 
    ON f.id = cache_fso.fileId AND cache_fso.storageType = 'CACHE_SEAWEED'
LEFT JOIN file_storage_objects nas_fso 
    ON f.id = nas_fso.fileId AND nas_fso.storageType = 'NAS'
WHERE 
    f.state = 'ACTIVE'
    AND f.name ILIKE '%' || :query || '%'
    -- searchPath 필터 (전체 검색 시 생략)
    AND (:searchPath IS NULL OR fo.path LIKE :searchPath || '%')
    -- 추가 필터
    AND (:mimeType IS NULL OR f.mimeType LIKE :mimeType)
    AND (:minSize IS NULL OR f.bytes >= :minSize)
    AND (:maxSize IS NULL OR f.bytes <= :maxSize)
    AND (:modifiedAfter IS NULL OR f.updatedAt >= :modifiedAfter)
    AND (:modifiedBefore IS NULL OR f.updatedAt <= :modifiedBefore)

UNION ALL

-- 폴더 검색
SELECT 
    fo.id,
    fo.name,
    'FOLDER' as type,
    fo.path,
    -- parentPath 계산 (상위 폴더 경로)
    CASE 
        WHEN fo.parentId IS NULL THEN '/'
        ELSE (SELECT path FROM folders WHERE id = fo.parentId)
    END as parentPath,
    NULL as mimeType,
    NULL as bytes,
    fo.updatedAt as modifiedAt,
    fo.createdAt,
    JSON_BUILD_OBJECT(
        'nas', fso.availabilityStatus
    ) as storageStatus
FROM folders fo
LEFT JOIN folder_storage_objects fso 
    ON fo.id = fso.folderId AND fso.storageType = 'NAS'
WHERE 
    fo.state = 'ACTIVE'
    AND fo.name ILIKE '%' || :query || '%'
    -- searchPath 필터 (전체 검색 시 생략)
    AND (:searchPath IS NULL OR fo.path LIKE :searchPath || '%')

-- 정렬 및 페이지네이션
ORDER BY 
    CASE WHEN :sortBy = 'NAME' AND :sortOrder = 'ASC' THEN name END ASC,
    CASE WHEN :sortBy = 'NAME' AND :sortOrder = 'DESC' THEN name END DESC,
    CASE WHEN :sortBy = 'SIZE' AND :sortOrder = 'ASC' THEN bytes END ASC NULLS LAST,
    CASE WHEN :sortBy = 'SIZE' AND :sortOrder = 'DESC' THEN bytes END DESC NULLS LAST,
    CASE WHEN :sortBy = 'MODIFIED_AT' AND :sortOrder = 'ASC' THEN modifiedAt END ASC,
    CASE WHEN :sortBy = 'MODIFIED_AT' AND :sortOrder = 'DESC' THEN modifiedAt END DESC,
    CASE WHEN :sortBy = 'TYPE' AND :sortOrder = 'ASC' THEN type END ASC,
    CASE WHEN :sortBy = 'TYPE' AND :sortOrder = 'DESC' THEN type END DESC
LIMIT :limit OFFSET :offset;
```

### 총 결과 수 카운트 쿼리

```sql
SELECT 
    (SELECT COUNT(*) FROM files f 
     INNER JOIN folders fo ON f.folderId = fo.id
     WHERE f.state = 'ACTIVE' 
       AND f.name ILIKE '%' || :query || '%'
       AND (:searchPath IS NULL OR fo.path LIKE :searchPath || '%')
       -- 필터 조건들...
    ) +
    (SELECT COUNT(*) FROM folders fo
     WHERE fo.state = 'ACTIVE'
       AND fo.name ILIKE '%' || :query || '%'
       AND (:searchPath IS NULL OR fo.path LIKE :searchPath || '%')
    ) as totalCount;
```

---

## 검색어 자동완성

### 플로우

```
┌─────────────────────────────────────────────────────────────────────┐
│  [자동완성 플로우]                                                    │
│                                                                     │
│  1. 사용자 입력: "rep" (3자 이상 입력 시 트리거)                      │
│                                                                     │
│  2. API 호출: GET /api/search/suggestions?q=rep&limit=10            │
│                                                                     │
│  3. 검색 처리:                                                       │
│     ┌─────────────────────────────────────────────────────────────┐ │
│     │ a) 파일명에서 "rep"로 시작하는 항목 조회                     │ │
│     │ b) 폴더명에서 "rep"로 시작하는 항목 조회                     │ │
│     │ c) 최근 검색어에서 "rep" 포함 항목 조회 (선택)               │ │
│     │ d) 결과 병합 및 중복 제거                                    │ │
│     └─────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  4. 응답:                                                            │
│     {                                                               │
│       "suggestions": [                                              │
│         { "text": "report.md", "type": "FILE" },                    │
│         { "text": "reports", "type": "FOLDER" },                    │
│         { "text": "repository", "type": "FOLDER" }                  │
│       ]                                                             │
│     }                                                               │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 자동완성 쿼리

```sql
-- 파일명 자동완성 (prefix 매칭, 더 빠름)
SELECT DISTINCT name, 'FILE' as type
FROM files
WHERE state = 'ACTIVE' AND name ILIKE :query || '%'
ORDER BY name
LIMIT 5

UNION ALL

-- 폴더명 자동완성
SELECT DISTINCT name, 'FOLDER' as type
FROM folders
WHERE state = 'ACTIVE' AND name ILIKE :query || '%'
ORDER BY name
LIMIT 5;
```

---

## API 응답 형식

### 검색 결과 응답

```json
{
  "success": true,
  "data": {
    "query": "report",
    "searchPath": "/project",
    "results": [
      {
        "id": "file-uuid-1",
        "name": "report.md",
        "type": "FILE",
        "path": "/project/docs/report.md",
        "parentPath": "/project/docs",
        "mimeType": "text/markdown",
        "bytes": 15360,
        "modifiedAt": "2026-01-15T10:30:00Z",
        "createdAt": "2026-01-10T09:00:00Z",
        "storageStatus": {
          "cache": "AVAILABLE",
          "nas": "AVAILABLE"
        }
      },
      {
        "id": "folder-uuid-1",
        "name": "reports",
        "type": "FOLDER",
        "path": "/project/reports",
        "parentPath": "/project",
        "mimeType": null,
        "bytes": null,
        "modifiedAt": "2026-01-18T14:20:00Z",
        "createdAt": "2026-01-05T11:00:00Z",
        "storageStatus": {
          "nas": "AVAILABLE"
        }
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "totalCount": 45,
      "totalPages": 3,
      "hasNext": true,
      "hasPrev": false
    },
    "filters": {
      "type": "ALL",
      "mimeTypes": null,
      "minSize": null,
      "maxSize": null,
      "modifiedAfter": null,
      "modifiedBefore": null
    },
    "sort": {
      "by": "NAME",
      "order": "ASC"
    },
    "executionTimeMs": 45
  },
  "timestamp": "2026-01-20T10:00:00Z"
}
```

### 자동완성 응답

```json
{
  "success": true,
  "data": {
    "query": "rep",
    "suggestions": [
      { "text": "report.md", "type": "FILE", "path": "/project/docs/report.md" },
      { "text": "reports", "type": "FOLDER", "path": "/project/reports" },
      { "text": "repository", "type": "FOLDER", "path": "/repository" },
      { "text": "2024-report.pdf", "type": "FILE", "path": "/archive/2024-report.pdf" }
    ]
  },
  "timestamp": "2026-01-20T10:00:00Z"
}
```

---

## 성능 최적화

### 1. 인덱스 전략

```sql
-- files 테이블 인덱스
CREATE INDEX idx_files_name_active ON files(name) WHERE state = 'ACTIVE';
CREATE INDEX idx_files_name_lower ON files(LOWER(name)) WHERE state = 'ACTIVE';

-- folders 테이블 인덱스
CREATE INDEX idx_folders_name_active ON folders(name) WHERE state = 'ACTIVE';
CREATE INDEX idx_folders_path ON folders(path) WHERE state = 'ACTIVE';

-- 복합 인덱스 (경로 기반 검색 최적화)
CREATE INDEX idx_folders_path_name ON folders(path, name) WHERE state = 'ACTIVE';
```

### 2. 전문 검색 (Full-Text Search)

**PostgreSQL tsvector 활용**

```sql
-- 검색 인덱스 컬럼 추가
ALTER TABLE files ADD COLUMN search_vector tsvector;
ALTER TABLE folders ADD COLUMN search_vector tsvector;

-- 트리거로 자동 업데이트
CREATE TRIGGER files_search_update
BEFORE INSERT OR UPDATE ON files
FOR EACH ROW EXECUTE FUNCTION
tsvector_update_trigger(search_vector, 'pg_catalog.simple', name);

-- 전문 검색 쿼리
SELECT * FROM files
WHERE search_vector @@ plainto_tsquery('simple', :query)
  AND state = 'ACTIVE';
```

### 3. 캐싱 전략---추후

```
┌─────────────────────────────────────────────────────────────────────┐
│  [검색 캐싱 전략]                                                     │
│                                                                     │
│  1. 인기 검색어 결과 캐싱                                             │
│     - Redis에 검색어 + 결과 캐싱                                     │
│     - TTL: 5분 (파일 변경 빈도에 따라 조정)                          │
│     - 캐시 키: search:{userId}:{queryHash}:{filtersHash}            │
│                                                                     │
│  2. 자동완성 결과 캐싱                                                │
│     - 자주 사용되는 prefix 결과 캐싱                                 │
│     - TTL: 10분                                                     │
│     - 캐시 키: autocomplete:{prefix}                                │
│                                                                     │
│  3. 캐시 무효화                                                       │
│     - 파일/폴더 생성/수정/삭제 시 관련 캐시 무효화                    │
│     - 이벤트 기반 무효화 (file_events, folder_events 활용)           │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 4. 페이지네이션 최적화

```
┌─────────────────────────────────────────────────────────────────────┐
│  [페이지네이션 전략]                                                  │
│                                                                     │
│  1. Offset 기반 (기본)                                               │
│     - 간단한 구현                                                   │
│     - 대용량 데이터에서 성능 저하                                    │
│     - LIMIT 20 OFFSET 1000 → 느림                                  │
│                                                                     │
│  2. Cursor 기반 (권장, 대용량)                                       │
│     - 마지막 결과의 ID/정렬키를 커서로 사용                          │
│     - WHERE id > :lastId ORDER BY id LIMIT 20                      │
│     - 일관된 성능                                                   │
│                                                                     │
│  3. 하이브리드                                                       │
│     - 처음 N페이지는 Offset                                         │
│     - 그 이후는 Cursor 기반                                         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 유즈 케이스

### UC-01. 전체 검색

**액터**: 내부 사용자

**선행 조건**:
- 사용자가 로그인 상태

**기본 플로우**:
```
1. 사용자가 검색창에 "report" 입력
2. 시스템이 전체 파일/폴더에서 "report" 포함된 항목 검색
3. 검색 결과를 이름순으로 정렬하여 표시
4. 각 결과에 대해 이름, 경로, 유형, 크기, 수정일 표시
5. 결과 클릭 시 해당 파일/폴더 위치로 이동
```

**대안 플로우**:
- 2a. 검색 결과 없음 → "검색 결과가 없습니다" 메시지 표시
- 3a. 사용자가 정렬 기준 변경 → 재정렬하여 표시

---

### UC-02. 특정 폴더 하위 검색

**액터**: 내부 사용자

**선행 조건**:
- 사용자가 로그인 상태
- 현재 특정 폴더(/project) 위치에 있음

**기본 플로우**:
```
1. 사용자가 현재 폴더에서 "현재 폴더 내 검색" 옵션 선택
2. 검색창에 "config" 입력
3. 시스템이 /project 하위에서만 "config" 포함된 항목 검색
4. 검색 결과 표시 (범위 제한됨을 표시)
```

---

### UC-03. 필터 적용 검색

**액터**: 내부 사용자

**선행 조건**:
- 사용자가 로그인 상태

**기본 플로우**:
```
1. 사용자가 검색창에 "document" 입력
2. 필터 패널 열기
3. 파일 유형: PDF만 선택
4. 파일 크기: 1MB ~ 10MB
5. 수정일: 최근 7일
6. "검색" 클릭
7. 필터 조건에 맞는 결과만 표시
```

---

### UC-04. 검색어 자동완성

**액터**: 내부 사용자

**선행 조건**:
- 사용자가 로그인 상태

**기본 플로우**:
```
1. 사용자가 검색창에 "rep" 입력 (3자 이상)
2. 시스템이 0.3초 디바운스 후 자동완성 API 호출
3. "rep"로 시작하는 파일명/폴더명 목록 표시
4. 사용자가 "report.md" 선택
5. 검색창에 "report.md" 자동 입력 및 검색 실행
```

---

## 보안 고려사항

### 1. 접근 권한

```
┌─────────────────────────────────────────────────────────────────────┐
│  [검색 권한 제어]                                                     │
│                                                                     │
│  1. 기본 정책                                                        │
│     - 로그인한 사용자만 검색 가능                                    │
│     - 자신이 접근 가능한 파일/폴더만 검색 결과에 포함                │
│                                                                     │
│  2. 권한 기반 필터링 (확장)                                          │
│     - 파일/폴더별 접근 권한 체크 후 결과 필터링                      │
│     - 검색 쿼리에 권한 조건 추가                                     │
│                                                                     │
│  3. 민감 데이터 보호                                                  │
│     - 특정 폴더(예: /admin, /system) 검색 제외                       │
│     - 검색 로그에 민감 정보 마스킹                                   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2. 입력 검증

```
┌─────────────────────────────────────────────────────────────────────┐
│  [검색어 검증]                                                        │
│                                                                     │
│  1. 길이 제한                                                        │
│     - 최소: 1자                                                     │
│     - 최대: 100자                                                   │
│                                                                     │
│  2. 특수문자 이스케이프                                               │
│     - SQL Injection 방지                                            │
│     - LIKE 와일드카드 이스케이프 (%, _)                              │
│                                                                     │
│  3. Rate Limiting                                                   │
│     - 사용자당 검색 요청 제한 (예: 100회/분)                         │
│     - 자동완성 요청 제한 (예: 200회/분)                              │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 프론트엔드 UX

### 검색 UI 구성

```
┌─────────────────────────────────────────────────────────────────────┐
│  [검색 UI]                                                           │
│                                                                     │
│  ┌───────────────────────────────────────────┐  ┌───────────┐       │
│  │ 🔍 파일, 폴더 검색...                      │  │ 필터 ▼   │       │
│  └───────────────────────────────────────────┘  └───────────┘       │
│                                                                     │
│  ☑ 현재 폴더 내에서만 검색 (/project/docs)                          │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  검색 결과 (45건) - 이름순 ▼                                         │
│                                                                     │
│  📁 reports              /project/reports         2026-01-18        │
│  📄 report.md    15KB    /project/docs/report.md  2026-01-15        │
│  📄 2024-report.pdf 2MB  /archive/2024-report.pdf 2025-12-20        │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  < 1 2 3 ... 3 >                                                    │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 필터 패널

```
┌─────────────────────────────────────────────────────────────────────┐
│  [필터 패널]                                                         │
│                                                                     │
│  유형                                                                │
│  ○ 전체  ● 파일만  ○ 폴더만                                         │
│                                                                     │
│  파일 형식                                                           │
│  ☐ 문서 (PDF, DOC, TXT)                                             │
│  ☐ 이미지 (JPG, PNG, GIF)                                           │
│  ☐ 동영상 (MP4, AVI)                                                │
│  ☐ 압축파일 (ZIP, RAR)                                              │
│                                                                     │
│  파일 크기                                                           │
│  [     ] MB ~ [     ] MB                                            │
│                                                                     │
│  수정일                                                              │
│  [시작일 📅] ~ [종료일 📅]                                           │
│  ○ 오늘  ○ 최근 7일  ○ 최근 30일  ○ 직접 선택                      │
│                                                                     │
│  ┌─────────┐  ┌─────────┐                                           │
│  │ 초기화  │  │  적용   │                                           │
│  └─────────┘  └─────────┘                                           │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 확장 고려사항

### 1. 고급 검색 기능

- **정규식 검색**: 파일명 패턴 매칭
- **파일 내용 검색**: 텍스트 파일 내용 검색 (Elasticsearch 연동)---추후
- **메타데이터 검색**: 작성자, 태그 등 추가 메타 검색---추후
- **유사 파일 찾기**: 중복 파일 검색---추후

### 2. 검색 분석

- **인기 검색어 대시보드**: 자주 검색되는 키워드 분석---추후
- **검색 실패 분석**: 결과 없는 검색어 분석 → 콘텐츠 개선---추후
- **검색 성능 모니터링**: 느린 검색 쿼리 최적화

### 3. 검색 히스토리

- **개인 검색 기록**: 최근 검색어 저장 및 재사용
- **저장된 검색**: 자주 사용하는 검색 조건 저장---추후
- **검색 공유**: 검색 결과 URL 공유---추후
